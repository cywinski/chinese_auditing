# Configuration for SAE feature density calculation
# Computes how frequently each SAE feature activates on the Pile dataset

# Model configuration
model: "Qwen/Qwen3-32B"

# SAE configuration
sae_repo_id: "adamkarvonen/qwen3-32b-saes"
sae_layer: 32  # Layer for SAE (50% depth)
sae_trainer: 2  # Trainer ID

# Dataset configuration
dataset: "monology/pile-uncopyrighted"
dataset_split: "train"
n_tokens: 2_000_000  # Number of tokens to process (set to -1 for unlimited)
max_seq_len: 512  # Maximum sequence length per sample

# Processing configuration
batch_size: 8  # Number of sequences per batch
seed: 42

# Checkpoint configuration
checkpoint_every: 1_000_000  # Save checkpoint every N tokens
checkpoint_dir: "output/sae_feature_density/density_checkpoints"

# Output path for final density tensor
output_path: "output/sae_feature_density/feature_density_layer32.pt"
